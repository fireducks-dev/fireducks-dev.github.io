<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://fireducks-dev.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://fireducks-dev.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://fireducks-dev.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://fireducks-dev.github.io/main.280962f974eb82354c447978a6574463448ea8c1d8e7874c8642a004f5713d4dba64daa30b7bc622b650b58c5de2666e72015e3d2cc02195358f9693469d5b94.css integrity="sha512-KAli+XTrgjVMRHl4pldEY0SOqMHY54dMhkKgBPVxPU26ZNqjC3vGIrZQtYxd4mZucgFePSzAIZU1j5aTRp1blA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Acceleration technology inside FireDucks - FireDucks</title><meta name=description content="TBD"><link rel=canonical href=https://fireducks-dev.github.io/en/posts/est/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Acceleration technology inside FireDucks"><meta property="og:description" content="TBD"><meta property="og:url" content="https://fireducks-dev.github.io/en/posts/est/"><meta property="og:site_name" content="FireDucks"><meta property="article:published_time" content="2023-12-05T00:00:00+09:00"><meta property="article:modified_time" content="2023-12-05T00:00:00+09:00"><meta property="og:image" content="https://fireducks-dev.github.io/fireducks.png"><meta property="og:image:alt" content="FireDucks"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@fireducksdev"><meta name=twitter:creator content="@fireducksdev"><meta name=twitter:title content="Acceleration technology inside FireDucks"><meta name=twitter:description content="TBD"><meta name=twitter:image content="https://fireducks-dev.github.io/fireducks.png"><meta name=twitter:image:alt content="Acceleration technology inside FireDucks"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://fireducks-dev.github.io/#/schema/organization/1","name":"FireDucks","url":"https://fireducks-dev.github.io/","sameAs":["https://twitter.com/fireducks","https://github.com/fireducks-dev"],"logo":{"@type":"ImageObject","@id":"https://fireducks-dev.github.io/#/schema/image/1","url":"https://fireducks-dev.github.io/fireducks.png","width":666,"height":298,"caption":"FireDucks"},"image":{"@id":"https://fireducks-dev.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://fireducks-dev.github.io/#/schema/website/1","url":"https://fireducks-dev.github.io/","name":"FireDucks","description":"FireDucks is a fast dataframe python library with pandas api","publisher":{"@id":"https://fireducks-dev.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://fireducks-dev.github.io/en/posts/est/","url":"https://fireducks-dev.github.io/en/posts/est/","name":"Acceleration technology inside FireDucks","description":"TBD","isPartOf":{"@id":"https://fireducks-dev.github.io/#/schema/website/1"},"about":{"@id":"https://fireducks-dev.github.io/#/schema/organization/1"},"datePublished":"2023-12-05T00:00:00CET","dateModified":"2023-12-05T00:00:00CET","breadcrumb":{"@id":"https://fireducks-dev.github.io/en/posts/est/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://fireducks-dev.github.io/en/posts/est/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://fireducks-dev.github.io/en/posts/est/"]}]},{"@type":"BreadcrumbList","@id":"https://fireducks-dev.github.io/en/posts/est/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://fireducks-dev.github.io/","url":"https://fireducks-dev.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://fireducks-dev.github.io/en/","url":"https://fireducks-dev.github.io/en/","name":"En"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://fireducks-dev.github.io/en/posts/","url":"https://fireducks-dev.github.io/en/posts/","name":"Posts"}},{"@type":"ListItem","position":4,"item":{"@id":"https://fireducks-dev.github.io/en/posts/est/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://fireducks-dev.github.io/en/posts/est/#/schema/image/2","url":"https://fireducks-dev.github.io/fireducks.png","contentUrl":"https://fireducks-dev.github.io/fireducks.png","caption":"Acceleration technology inside FireDucks"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://fireducks-dev.github.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://fireducks-dev.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://fireducks-dev.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://fireducks-dev.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://fireducks-dev.github.io/site.webmanifest></head><body class="posts single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/en/ aria-label=FireDucks>FireDucks</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/en/>FireDucks</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1" href=/en/docs/get-started/get-started/>Get Started</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/en/docs/user-guide/01-intro/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/en/docs/benchmarks/benchmarks/>Benchmarks</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/en/docs/about-us/about-us/>About Us</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/fireducksdev><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1200 1227" fill="currentcolor" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M714.163 519.284 1160.89.0H1055.03L667.137 450.887 357.328.0H0L468.492 681.821.0 1226.37H105.866L515.491 750.218 842.672 1226.37H12e2L714.137 519.284H714.163zM569.165 687.828l-47.468-67.894L144.011 79.6944H306.615L611.412 515.685l47.468 67.894 396.2 566.721H892.476L569.165 687.854V687.828z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
English
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-languages><li><a class="dropdown-item current" aria-current=true href=/en/posts/est/>English</a></li><li><hr class=dropdown-divider></li><li><a class=dropdown-item rel=alternate href=/ja/posts/est/ hreflang=ja lang=ja>Japanese</a></li></ul></div><a class="btn btn-primary mb-1" href=/en/docs/get-started/get-started/#install>Try for Free</a></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><article><div class="row justify-content-center"><div class="col-md-12 col-lg-12"><div class=blog-header><h1>Acceleration technology inside FireDucks</h1><p><small>Posted&nbsp;on&nbsp;December 5, 2023 by
Masashi Kotera</small></p></div></div><div class="col-md-12 col-lg-12"><h2 id=switching-groupby>SWITCHING GROUPBY <a href=#switching-groupby class=anchor aria-hidden=true>#</a></h2><p>In this article, we introduce the acceleration techniques of &ldquo;groupby&rdquo; used in FireDucks.</p><p>The groupby operation is one of the most fundamental and important operations in tabular data analysis.
We can use the groupby operation to obtain important statistical properties such as the mean and variance of the data.
We can also combine it with other operations to obtain new features.</p><p>FireDucks optimizes based on data characteristics for fast groupby operations.
One such optimization is the automatic selection of groupby algorithms based on the number of groups.
FireDucks&rsquo; groupby algorithm focuses on the number of groups of data and switches between an algorithm that is fast for data with a small number of groups (Algorithm A) and an algorithm that is fast for data with a large number of groups (Algorithm B).
The number of groups indicates the type of data that make up the target column.</p><p>Consider the following tabular data.</p><table><thead><tr><th></th><th>food</th><th>category</th></tr></thead><tbody><tr><td>0</td><td>apple</td><td>fruit</td></tr><tr><td>1</td><td>carrot</td><td>vegetable</td></tr><tr><td>2</td><td>peach</td><td>fruit</td></tr><tr><td>3</td><td>onion</td><td>vegetable</td></tr><tr><td>4</td><td>grape</td><td>fruit</td></tr></tbody></table><p>There are five elements that make up the “food” column: “apple”, “carrot”, “peach”, “onion”, and “grape”.
Therefore, the number of groups in the “food” column is 5.
Next, we see that there are two types of elements that make up the “category” column: fruit and vegetable. Therefore, the number of groups in the “category” column is 2.</p><p>Calculating the number of groups for large data sets is time-consuming.
Therefore, FireDucks uses a statistical method to estimate the number of groups without obtaining an exact value for the number of groups<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.
The estimation is performed as follows.</p><ol><li>Extracts a random piece of data from a sequence of data of interest.</li><li>Record that data.</li><li>Again, take out one data at random from the column of data of interest.</li><li>That data is checked to see if it matches the recorded data and record.</li><li>Repeat operations 3 and 4 multiple times.</li></ol><p>After repeating operations 3 and 4 multiple times, FireDucks estimates the number of groups of data in the group key of interest from the number of times the data was retrieved and the number of matches.</p><h2 id=evaluation>Evaluation <a href=#evaluation class=anchor aria-hidden=true>#</a></h2><p>We measured the calculation speed using TPC-H, a benchmark that includes many processes related to data analysis.</p><img src=../../../ja/posts/est/compare.png width=80%><p>“A" uses only Algorithm A for groupby operations, and &ldquo;B&rdquo; uses only Algorithm B for groupby operations.
“auto" estimates the number of groups and automatically selects between Algorithm A and B for the groupby operation.</p><p>Processes for which there is little difference in execution time between Algorithm A and Algorithm B are omitted from the above graph.
The graph shows that, with the exception of q10, the automatic selection algorithm is the faster of Algorithm A and Algorithm B.</p><p>The total shows the computation time for the entire TPC-H, including the processes excluded from the above graph for Algorithm A, Algorithm B, and the automatic selection algorithm. This indicates that the automatic selection algorithm is about 3 times faster than Algorithm A, and about 1.2 times faster than Algorithm B for TPC-H as a whole.</p><h2 id=reference>Reference <a href=#reference class=anchor aria-hidden=true>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>M. Bressan, E. Peserico, and L. Pretto. Simple set cardinality estimation through random sampling. CoRR, abs/1512.07901, 2015.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></div></article></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://gohugo.io/>Hugo</a> and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.7315382e899a7d7132d93fdf0d6682c67a93f0e72ee1a757f33f3207de3b14e2460a935c9d4cec78f86d94ab892d053c70540695eed0bbb7bf5bdc979e6f5a9f.js integrity="sha512-cxU4LomafXEy2T/fDWaCxnqT8Ocu4adX8z8yB947FOJGCpNcnUzsePhtlKuJLQU8cFQGle7Qu7e/W9yXnm9anw==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.8b2d7ddd72ba2c88d5107387eb3b66b90f1f864fd5afef6aed284425efb5919a9bc092f653f2985a205b85b0a158f70b460643ba2b71ccf7d3c1c107c3a4b609.js integrity="sha512-iy193XK6LIjVEHOH6ztmuQ8fhk/Vr+9q7ShEJe+1kZqbwJL2U/KYWiBbhbChWPcLRgZDuitxzPfTwcEHw6S2CQ==" crossorigin=anonymous defer></script>
<script src=/main.min.57d9a84956f7d60008c47938c7fdd2f75e8618ff1d09c5a5e2b32f91debaf7681f7ceca8b51aded60067c2136172134a91ebc0674487c76a04e3244d927ebdde.js integrity="sha512-V9moSVb31gAIxHk4x/3S916GGP8dCcWl4rMvkd6692gffOyotRre1gBnwhNhchNKkevAZ0SHx2oE4yRNkn693g==" crossorigin=anonymous defer></script>
<script src=https://fireducks-dev.github.io/index.min.e7cb668cf26edca68c5bcbe2b5c4950f0835bcb142801580624033e71dedcc4a2b495a1803c656616a87f8a6567deafddbfc63d239053b5a816d31fc45b67b9a.js integrity="sha512-58tmjPJu3KaMW8vitcSVDwg1vLFCgBWAYkAz5x3tzEorSVoYA8ZWYWqH+KZWfer92/xj0jkFO1qBbTH8RbZ7mg==" crossorigin=anonymous defer></script></body></html>