<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Tips | FireDucks</title>
<meta name=description content="The know-how of pandas, such as avoiding loops and apply, is also useful for FireDucks. Here are some tips to improve performance in FireDucks.
Avoid loops Looping out data from a DataFrame is slow, so it is better to use the DataFrame API as much as possible (this is also true for pandas).
For example, the following loop processes the elements of a Series one by one.
s = 0 for i in range(len(df)): if df[&amp;#34;A&amp;#34;]."><meta property="og:title" content="Tips"><meta property="og:description" content="The know-how of pandas, such as avoiding loops and apply, is also useful for FireDucks. Here are some tips to improve performance in FireDucks.
Avoid loops Looping out data from a DataFrame is slow, so it is better to use the DataFrame API as much as possible (this is also true for pandas).
For example, the following loop processes the elements of a Series one by one.
s = 0 for i in range(len(df)): if df[&#34;A&#34;]."><meta property="og:type" content="article"><meta property="og:url" content="https://fireducks-dev.github.io/docs/user-guide/tips/"><meta property="article:section" content="docs"><meta itemprop=name content="Tips"><meta itemprop=description content="The know-how of pandas, such as avoiding loops and apply, is also useful for FireDucks. Here are some tips to improve performance in FireDucks.
Avoid loops Looping out data from a DataFrame is slow, so it is better to use the DataFrame API as much as possible (this is also true for pandas).
For example, the following loop processes the elements of a Series one by one.
s = 0 for i in range(len(df)): if df[&#34;A&#34;]."><meta itemprop=wordCount content="417"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Tips"><meta name=twitter:description content="The know-how of pandas, such as avoiding loops and apply, is also useful for FireDucks. Here are some tips to improve performance in FireDucks.
Avoid loops Looping out data from a DataFrame is slow, so it is better to use the DataFrame API as much as possible (this is also true for pandas).
For example, the following loop processes the elements of a Series one by one.
s = 0 for i in range(len(df)): if df[&#34;A&#34;]."><link rel=preload href=/scss/main.min.2404b01c5fb65f0b4d76f0c632723d405f2faf20557f5aeff94d8efb2e91ec8b.css as=style><link href=/scss/main.min.2404b01c5fb65f0b4d76f0c632723d405f2faf20557f5aeff94d8efb2e91ec8b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.3.min.js integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar navbar-dark js-navbar-scroll"><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>FireDucks</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/get-started><span>Get Started</span></a></li><li class=nav-item><a class=nav-link href=/docs/user-guide/01-intro/><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/posts><span>Blogs</span></a></li><li class=nav-item><a class=nav-link href=/docs/benchmarks><span>Benchmarks</span></a></li><li class=nav-item><a class=nav-link href=/docs/about-us><span>About Us</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/ja/docs/user-guide/tips/>Japanese</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/ja/docs/user-guide/tips/>Japanese</a></li></ul></div></div><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Docs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsget-started-li><a href=/docs/get-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsget-started><span>Get Started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docsuser-guide-li><a href=/docs/user-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsuser-guide><span>User Guide</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuser-guide01-intro-li><a href=/docs/user-guide/01-intro/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser-guide01-intro><span>Introduction</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuser-guide02-exec-model-li><a href=/docs/user-guide/02-exec-model/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser-guide02-exec-model><span>Execution Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuser-guide03-acceleration-li><a href=/docs/user-guide/03-acceleration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser-guide03-acceleration><span>Acceleration in FireDucks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuser-guide04-compatibility-li><a href=/docs/user-guide/04-compatibility/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser-guide04-compatibility><span>pandas compatibility</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuser-guide05-api-li><a href=/docs/user-guide/05-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuser-guide05-api><span>FireDucks Own API</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docsuser-guidetips-li><a href=/docs/user-guide/tips/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-docsuser-guidetips><span class=td-sidebar-nav-active-item>Tips</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsbenchmarks-li><a href=/docs/benchmarks/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsbenchmarks><span>Benchmarks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsuse-case-li><a href=/docs/use-case/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsuse-case><span>Use Cases</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuse-casedata-scientist-li><a href=/docs/use-case/data-scientist/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuse-casedata-scientist><span>All Data Scientists</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsuse-caseindustries-li><a href=/docs/use-case/industries/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsuse-caseindustries><span>Highly suitable use cases</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsrelease-note-li><a href=/docs/release-note/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsrelease-note><span>Release Note</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsabout-us-li><a href=/docs/about-us/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsabout-us><span>About Us</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshelp-li><a href=/docs/help/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docshelp><span>Help</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshelpfaq-li><a href=/docs/help/faq/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docshelpfaq><span>FAQ</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshelpcontact-li><a href=/docs/help/contact/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docshelpcontact><span>Contact</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#avoid-loops>Avoid loops</a></li><li><a href=#do-not-use-apply>Do not use apply</a></li><li><a href=#do-not-use-attribute-style-column-references>Do not use attribute-style column references</a></li><li><a href=#do-not-use-undefined-behavior-of-pandas>Do not use undefined behavior of pandas</a></li><li><a href=#avoid-fallback>Avoid Fallback</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Docs</a></li><li class=breadcrumb-item><a href=/docs/user-guide/>User Guide</a></li><li class="breadcrumb-item active" aria-current=page>Tips</li></ol></nav><div class=td-content><h1>Tips</h1><header class=article-meta></header><p>The know-how of pandas, such as avoiding loops and apply, is also useful for FireDucks. Here are some tips to improve performance in FireDucks.</p><h2 id=avoid-loops>Avoid loops</h2><p>Looping out data from a DataFrame is slow, so it is better to use the DataFrame API as much as possible (this is also true for pandas).</p><p>For example, the following loop processes the elements of a Series one by one.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>s <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(df)): <span style=color:#66d9ef>if</span> df[<span style=color:#e6db74>&#34;A&#34;</span>]<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> df[<span style=color:#e6db74>&#34;A&#34;</span>][i] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>: s <span style=color:#f92672>+=</span> df[<span style=color:#e6db74>&#34;B&#34;</span>][i] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        s <span style=color:#f92672>+=</span> df[<span style=color:#e6db74>&#34;B&#34;</span>][i]<span style=color:#f92672>.</span>
</span></span></code></pre></div><p>Using the API, you can write the following.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>s <span style=color:#f92672>=</span> df[df[<span style=color:#e6db74>&#34;A&#34;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>][<span style=color:#e6db74>&#34;B&#34;</span>]<span style=color:#f92672>.</span>sum()
</span></span></code></pre></div><p>The same applies to <code>Dataframe.iterrows</code> and so on.</p><h2 id=do-not-use-apply>Do not use apply</h2><p>Passing user-defined functions such as <code>DataFrame.apply</code> is not currently supported by FireDucks&rsquo; current optimizer that generates an intermediate language and compiles it.</p><h2 id=do-not-use-attribute-style-column-references>Do not use attribute-style column references</h2><p>Column references can be written as <code>df["A"]</code> or <code>df.A</code>, but the latter may conflict with the original attributes of the DataFrame, so it is better to write <code>df["A"]</code> in bracket format.</p><p>In FireDucks, the <code>df.A</code> format requires processing to determine whether <code>A</code> is a column name or not, which may result in loss of compiler optimization.</p><h2 id=do-not-use-undefined-behavior-of-pandas>Do not use undefined behavior of pandas</h2><p>Whether <code>df["A"]</code> returns a reference or a copy in the following cases is undefined in pandas, but if it returns a copy, <code>df</code> is not updated. In many cases this will not be the intended behavior.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df[<span style=color:#e6db74>&#34;A&#34;</span>][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span></code></pre></div><p>Such undefined behavior may work differently in FireDucks than in pandas, so what works in pandas may not work in FireDucks. It is better not to use undefined behavior.</p><p>In this example, it is safe to write the following. However, as mentioned above, element-by-element access is inefficient, so if another implementation is possible, it is better to use it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>  <span style=color:#75715e># if A is the first column</span>
</span></span></code></pre></div><h2 id=avoid-fallback>Avoid Fallback</h2><p>FireDucks has a feature called fallback that calls pandas internally. This is a feature to improve pandas compatibility by using pandas to perform functions not currently supported by FireDucks. On the other hand, this is a disadvantage in terms of execution time and memory usage, since it involves converting the FireDucks data structure to pandas, executing the pandas method, and then converting it to the FireDucks data structure again.</p><p>We are continuously working to reduce fallbacks, but it is also effective to improve performance by avoiding fallbacks in user programs. The environment variable <code>FIREDUCKS_FLAGS="-Wfallback"</code> can be used to log when fallbacks occur.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Post issues on GitHub issues" aria-label="Post issues on GitHub issues"><a target=_blank rel=noopener href=https://github.com/fireducks-dev/fireducks aria-label="Post issues on GitHub issues"><i class="fa-brands fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Send an e-mail to us" aria-label="Send an e-mail to us"><a target=_blank rel=noopener href=mailto:contact@fireducks.jp.nec.com aria-label="Send an e-mail to us"><i class="fa-solid fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Follow us in X" aria-label="Follow us in X"><a target=_blank rel=noopener href=https://x.com/fireducksdev aria-label="Follow us in X"><i class="fa-brands fa-x-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"></div><div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2"><span>&copy; 2024 FireDucks Dev Team All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.350b703200e2632331b6ab5a6c71195d176b52e89c9b70db7c43764d40b28d92.js integrity="sha256-NQtwMgDiYyMxtqtabHEZXRdrUuicm3DbfEN2TUCyjZI=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>